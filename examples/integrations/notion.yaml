name: "Notion"
nodes:
  - name: "Create Page"
    type: "action"
    implementation:
      type: "http"
      method: "POST"
      url: "https://api.notion.com/v1/pages"
      headers:
        Authorization: "Bearer {{ credential.token }}"
        Notion-Version: "2022-06-28"
        Content-Type: "application/json"
      body:
        parent: { "database_id": "{{ input.database_id }}" }
        properties:
          Name: 
            title: 
              - text: { content: "{{ input.title }}" }
          Summary:
            rich_text:
              - text: { content: "{{ input.summary }}" }

  - name: "Retrieve Page"
    type: "action"
    implementation:
      type: "http"
      method: "GET"
      url: "https://api.notion.com/v1/pages/{{ input.page_id }}"
      headers:
        Authorization: "Bearer {{ credential.token }}"
        Notion-Version: "2022-06-28"

  - name: "Update Page"
    type: "action"
    implementation:
      type: "http"
      method: "PATCH"
      url: "https://api.notion.com/v1/pages/{{ input.page_id }}"
      headers:
        Authorization: "Bearer {{ credential.token }}"
        Notion-Version: "2022-06-28"
        Content-Type: "application/json"
      body:
        properties: "{{ input.properties }}"
        archived: "{{ input.archived }}"

  - name: "Retrieve Block Children"
    type: "action"
    implementation:
      type: "http"
      method: "GET"
      url: "https://api.notion.com/v1/blocks/{{ input.block_id }}/children"
      headers:
        Authorization: "Bearer {{ credential.token }}"
        Notion-Version: "2022-06-28"

  - name: "Append Block Children"
    type: "action"
    implementation:
      type: "http"
      method: "PATCH"
      url: "https://api.notion.com/v1/blocks/{{ input.block_id }}/children"
      headers:
        Authorization: "Bearer {{ credential.token }}"
        Notion-Version: "2022-06-28"
        Content-Type: "application/json"
      body:
        children: "{{ input.children }}"

  - name: "Query Database"
    type: "action"
    implementation:
      type: "http"
      method: "POST"
      url: "https://api.notion.com/v1/databases/{{ input.database_id }}/query"
      headers:
        Authorization: "Bearer {{ credential.token }}"
        Notion-Version: "2022-06-28"
        Content-Type: "application/json"
      body:
        filter: "{{ input.filter }}"
        sorts: "{{ input.sorts }}"

  - name: "Retrieve Database"
    type: "action"
    implementation:
      type: "http"
      method: "GET"
      url: "https://api.notion.com/v1/databases/{{ input.database_id }}"
      headers:
        Authorization: "Bearer {{ credential.token }}"
        Notion-Version: "2022-06-28"

  - name: "Search"
    type: "action"
    implementation:
      type: "http"
      method: "POST"
      url: "https://api.notion.com/v1/search"
      headers:
        Authorization: "Bearer {{ credential.token }}"
        Notion-Version: "2022-06-28"
        Content-Type: "application/json"
      body:
        query: "{{ input.query }}"
        filter: "{{ input.filter }}"
        sort: "{{ input.sort }}"

  - name: "List Users"
    type: "action"
    implementation:
      type: "http"
      method: "GET"
      url: "https://api.notion.com/v1/users"
      headers:
        Authorization: "Bearer {{ credential.token }}"
        Notion-Version: "2022-06-28"

  - name: "Retrieve User"
    type: "action"
    implementation:
      type: "http"
      method: "GET"
      url: "https://api.notion.com/v1/users/{{ input.user_id }}"
      headers:
        Authorization: "Bearer {{ credential.token }}"
        Notion-Version: "2022-06-28"
